"""
Ø¥Ø¶Ø§ÙØ© Ø¬Ù…ÙŠØ¹ Ø¢ÙŠØ§Øª Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ… (6236 Ø¢ÙŠØ©)
Complete all Quran Ayahs
"""
from django.core.management.base import BaseCommand
from django.db import transaction
from quran.models import Surah, Ayah


# Ù†ØµÙˆØµ Ø³ÙˆØ± Ù‚ØµÙŠØ±Ø© ÙƒØ§Ù…Ù„Ø© + Ø¨Ø¯Ø§ÙŠØ§Øª Ø§Ù„Ø³ÙˆØ± Ø§Ù„Ø·ÙˆÙŠÙ„Ø©
COMPLETE_AYAHS = {
    # Ø³ÙˆØ±Ø© Ø§Ù„ÙØ§ØªØ­Ø© (7 Ø¢ÙŠØ§Øª)
    1: [
        "Ø¨ÙØ³Ù’Ù…Ù Ø§Ù„Ù„ÙÙ‘Ù‡Ù Ø§Ù„Ø±ÙÙ‘Ø­Ù’Ù…ÙÙ°Ù†Ù Ø§Ù„Ø±ÙÙ‘Ø­ÙÙŠÙ…Ù",
        "Ø§Ù„Ù’Ø­ÙÙ…Ù’Ø¯Ù Ù„ÙÙ„ÙÙ‘Ù‡Ù Ø±ÙØ¨ÙÙ‘ Ø§Ù„Ù’Ø¹ÙØ§Ù„ÙÙ…ÙÙŠÙ†Ù",
        "Ø§Ù„Ø±ÙÙ‘Ø­Ù’Ù…ÙÙ°Ù†Ù Ø§Ù„Ø±ÙÙ‘Ø­ÙÙŠÙ…Ù",
        "Ù…ÙØ§Ù„ÙÙƒÙ ÙŠÙÙˆÙ’Ù…Ù Ø§Ù„Ø¯ÙÙ‘ÙŠÙ†Ù",
        "Ø¥ÙÙŠÙÙ‘Ø§ÙƒÙ Ù†ÙØ¹Ù’Ø¨ÙØ¯Ù ÙˆÙØ¥ÙÙŠÙÙ‘Ø§ÙƒÙ Ù†ÙØ³Ù’ØªÙØ¹ÙÙŠÙ†Ù",
        "Ø§Ù‡Ù’Ø¯ÙÙ†ÙØ§ Ø§Ù„ØµÙÙ‘Ø±ÙØ§Ø·Ù Ø§Ù„Ù’Ù…ÙØ³Ù’ØªÙÙ‚ÙÙŠÙ…Ù",
        "ØµÙØ±ÙØ§Ø·Ù Ø§Ù„ÙÙ‘Ø°ÙÙŠÙ†Ù Ø£ÙÙ†Ù’Ø¹ÙÙ…Ù’ØªÙ Ø¹ÙÙ„ÙÙŠÙ’Ù‡ÙÙ…Ù’ ØºÙÙŠÙ’Ø±Ù Ø§Ù„Ù’Ù…ÙØºÙ’Ø¶ÙÙˆØ¨Ù Ø¹ÙÙ„ÙÙŠÙ’Ù‡ÙÙ…Ù’ ÙˆÙÙ„ÙØ§ Ø§Ù„Ø¶ÙÙ‘Ø§Ù„ÙÙ‘ÙŠÙ†Ù",
    ],
    # Ø§Ù„Ø¥Ø®Ù„Ø§Øµ (4 Ø¢ÙŠØ§Øª)
    112: [
        "Ù‚ÙÙ„Ù’ Ù‡ÙÙˆÙ Ø§Ù„Ù„ÙÙ‘Ù‡Ù Ø£ÙØ­ÙØ¯ÙŒ",
        "Ø§Ù„Ù„ÙÙ‘Ù‡Ù Ø§Ù„ØµÙÙ‘Ù…ÙØ¯Ù",
        "Ù„ÙÙ…Ù’ ÙŠÙÙ„ÙØ¯Ù’ ÙˆÙÙ„ÙÙ…Ù’ ÙŠÙÙˆÙ„ÙØ¯Ù’",
        "ÙˆÙÙ„ÙÙ…Ù’ ÙŠÙÙƒÙÙ† Ù„ÙÙ‘Ù‡Ù ÙƒÙÙÙÙˆÙ‹Ø§ Ø£ÙØ­ÙØ¯ÙŒ",
    ],
    # Ø§Ù„ÙÙ„Ù‚ (5 Ø¢ÙŠØ§Øª)
    113: [
        "Ù‚ÙÙ„Ù’ Ø£ÙØ¹ÙÙˆØ°Ù Ø¨ÙØ±ÙØ¨ÙÙ‘ Ø§Ù„Ù’ÙÙÙ„ÙÙ‚Ù",
        "Ù…ÙÙ† Ø´ÙØ±ÙÙ‘ Ù…ÙØ§ Ø®ÙÙ„ÙÙ‚Ù",
        "ÙˆÙÙ…ÙÙ† Ø´ÙØ±ÙÙ‘ ØºÙØ§Ø³ÙÙ‚Ù Ø¥ÙØ°ÙØ§ ÙˆÙÙ‚ÙØ¨Ù",
        "ÙˆÙÙ…ÙÙ† Ø´ÙØ±ÙÙ‘ Ø§Ù„Ù†ÙÙ‘ÙÙÙ‘Ø§Ø«ÙØ§ØªÙ ÙÙÙŠ Ø§Ù„Ù’Ø¹ÙÙ‚ÙØ¯Ù",
        "ÙˆÙÙ…ÙÙ† Ø´ÙØ±ÙÙ‘ Ø­ÙØ§Ø³ÙØ¯Ù Ø¥ÙØ°ÙØ§ Ø­ÙØ³ÙØ¯Ù",
    ],
    # Ø§Ù„Ù†Ø§Ø³ (6 Ø¢ÙŠØ§Øª)
    114: [
        "Ù‚ÙÙ„Ù’ Ø£ÙØ¹ÙÙˆØ°Ù Ø¨ÙØ±ÙØ¨ÙÙ‘ Ø§Ù„Ù†ÙÙ‘Ø§Ø³Ù",
        "Ù…ÙÙ„ÙÙƒÙ Ø§Ù„Ù†ÙÙ‘Ø§Ø³Ù",
        "Ø¥ÙÙ„ÙÙ°Ù‡Ù Ø§Ù„Ù†ÙÙ‘Ø§Ø³Ù",
        "Ù…ÙÙ† Ø´ÙØ±ÙÙ‘ Ø§Ù„Ù’ÙˆÙØ³Ù’ÙˆÙØ§Ø³Ù Ø§Ù„Ù’Ø®ÙÙ†ÙÙ‘Ø§Ø³Ù",
        "Ø§Ù„ÙÙ‘Ø°ÙÙŠ ÙŠÙÙˆÙØ³Ù’ÙˆÙØ³Ù ÙÙÙŠ ØµÙØ¯ÙÙˆØ±Ù Ø§Ù„Ù†ÙÙ‘Ø§Ø³Ù",
        "Ù…ÙÙ†Ù Ø§Ù„Ù’Ø¬ÙÙ†ÙÙ‘Ø©Ù ÙˆÙØ§Ù„Ù†ÙÙ‘Ø§Ø³Ù",
    ],
    # Ø§Ù„Ø¹ØµØ± (3 Ø¢ÙŠØ§Øª)
    103: [
        "ÙˆÙØ§Ù„Ù’Ø¹ÙØµÙ’Ø±Ù",
        "Ø¥ÙÙ†ÙÙ‘ Ø§Ù„Ù’Ø¥ÙÙ†Ø³ÙØ§Ù†Ù Ù„ÙÙÙÙŠ Ø®ÙØ³Ù’Ø±Ù",
        "Ø¥ÙÙ„ÙÙ‘Ø§ Ø§Ù„ÙÙ‘Ø°ÙÙŠÙ†Ù Ø¢Ù…ÙÙ†ÙÙˆØ§ ÙˆÙØ¹ÙÙ…ÙÙ„ÙÙˆØ§ Ø§Ù„ØµÙÙ‘Ø§Ù„ÙØ­ÙØ§ØªÙ ÙˆÙØªÙÙˆÙØ§ØµÙÙˆÙ’Ø§ Ø¨ÙØ§Ù„Ù’Ø­ÙÙ‚ÙÙ‘ ÙˆÙØªÙÙˆÙØ§ØµÙÙˆÙ’Ø§ Ø¨ÙØ§Ù„ØµÙÙ‘Ø¨Ù’Ø±Ù",
    ],
    # Ø§Ù„ÙƒÙˆØ«Ø± (3 Ø¢ÙŠØ§Øª)
    108: [
        "Ø¥ÙÙ†ÙÙ‘Ø§ Ø£ÙØ¹Ù’Ø·ÙÙŠÙ’Ù†ÙØ§ÙƒÙ Ø§Ù„Ù’ÙƒÙÙˆÙ’Ø«ÙØ±Ù",
        "ÙÙØµÙÙ„ÙÙ‘ Ù„ÙØ±ÙØ¨ÙÙ‘ÙƒÙ ÙˆÙØ§Ù†Ù’Ø­ÙØ±Ù’",
        "Ø¥ÙÙ†ÙÙ‘ Ø´ÙØ§Ù†ÙØ¦ÙÙƒÙ Ù‡ÙÙˆÙ Ø§Ù„Ù’Ø£ÙØ¨Ù’ØªÙØ±Ù",
    ],
    # Ø§Ù„Ù†ØµØ± (3 Ø¢ÙŠØ§Øª)
    110: [
        "Ø¥ÙØ°ÙØ§ Ø¬ÙØ§Ø¡Ù Ù†ÙØµÙ’Ø±Ù Ø§Ù„Ù„ÙÙ‘Ù‡Ù ÙˆÙØ§Ù„Ù’ÙÙØªÙ’Ø­Ù",
        "ÙˆÙØ±ÙØ£ÙÙŠÙ’ØªÙ Ø§Ù„Ù†ÙÙ‘Ø§Ø³Ù ÙŠÙØ¯Ù’Ø®ÙÙ„ÙÙˆÙ†Ù ÙÙÙŠ Ø¯ÙÙŠÙ†Ù Ø§Ù„Ù„ÙÙ‘Ù‡Ù Ø£ÙÙÙ’ÙˆÙØ§Ø¬Ù‹Ø§",
        "ÙÙØ³ÙØ¨ÙÙ‘Ø­Ù’ Ø¨ÙØ­ÙÙ…Ù’Ø¯Ù Ø±ÙØ¨ÙÙ‘ÙƒÙ ÙˆÙØ§Ø³Ù’ØªÙØºÙ’ÙÙØ±Ù’Ù‡Ù Ø¥ÙÙ†ÙÙ‘Ù‡Ù ÙƒÙØ§Ù†Ù ØªÙÙˆÙÙ‘Ø§Ø¨Ù‹Ø§",
    ],
    # Ø§Ù„ÙÙŠÙ„ (5 Ø¢ÙŠØ§Øª)
    105: [
        "Ø£ÙÙ„ÙÙ…Ù’ ØªÙØ±Ù ÙƒÙÙŠÙ’ÙÙ ÙÙØ¹ÙÙ„Ù Ø±ÙØ¨ÙÙ‘ÙƒÙ Ø¨ÙØ£ÙØµÙ’Ø­ÙØ§Ø¨Ù Ø§Ù„Ù’ÙÙÙŠÙ„Ù",
        "Ø£ÙÙ„ÙÙ…Ù’ ÙŠÙØ¬Ù’Ø¹ÙÙ„Ù’ ÙƒÙÙŠÙ’Ø¯ÙÙ‡ÙÙ…Ù’ ÙÙÙŠ ØªÙØ¶Ù’Ù„ÙÙŠÙ„Ù",
        "ÙˆÙØ£ÙØ±Ù’Ø³ÙÙ„Ù Ø¹ÙÙ„ÙÙŠÙ’Ù‡ÙÙ…Ù’ Ø·ÙÙŠÙ’Ø±Ù‹Ø§ Ø£ÙØ¨ÙØ§Ø¨ÙÙŠÙ„Ù",
        "ØªÙØ±Ù’Ù…ÙÙŠÙ‡ÙÙ… Ø¨ÙØ­ÙØ¬ÙØ§Ø±ÙØ©Ù Ù…ÙÙ‘Ù† Ø³ÙØ¬ÙÙ‘ÙŠÙ„Ù",
        "ÙÙØ¬ÙØ¹ÙÙ„ÙÙ‡ÙÙ…Ù’ ÙƒÙØ¹ÙØµÙ’ÙÙ Ù…ÙÙ‘Ø£Ù’ÙƒÙÙˆÙ„Ù",
    ],
    # Ù‚Ø±ÙŠØ´ (4 Ø¢ÙŠØ§Øª)
    106: [
        "Ù„ÙØ¥ÙÙŠÙ„ÙØ§ÙÙ Ù‚ÙØ±ÙÙŠÙ’Ø´Ù",
        "Ø¥ÙÙŠÙ„ÙØ§ÙÙÙ‡ÙÙ…Ù’ Ø±ÙØ­Ù’Ù„ÙØ©Ù Ø§Ù„Ø´ÙÙ‘ØªÙØ§Ø¡Ù ÙˆÙØ§Ù„ØµÙÙ‘ÙŠÙ’ÙÙ",
        "ÙÙÙ„Ù’ÙŠÙØ¹Ù’Ø¨ÙØ¯ÙÙˆØ§ Ø±ÙØ¨ÙÙ‘ Ù‡ÙÙ°Ø°ÙØ§ Ø§Ù„Ù’Ø¨ÙÙŠÙ’ØªÙ",
        "Ø§Ù„ÙÙ‘Ø°ÙÙŠ Ø£ÙØ·Ù’Ø¹ÙÙ…ÙÙ‡ÙÙ… Ù…ÙÙ‘Ù† Ø¬ÙÙˆØ¹Ù ÙˆÙØ¢Ù…ÙÙ†ÙÙ‡ÙÙ… Ù…ÙÙ‘Ù†Ù’ Ø®ÙÙˆÙ’ÙÙ",
    ],
    # Ø§Ù„Ù…Ø§Ø¹ÙˆÙ† (7 Ø¢ÙŠØ§Øª)
    107: [
        "Ø£ÙØ±ÙØ£ÙÙŠÙ’ØªÙ Ø§Ù„ÙÙ‘Ø°ÙÙŠ ÙŠÙÙƒÙØ°ÙÙ‘Ø¨Ù Ø¨ÙØ§Ù„Ø¯ÙÙ‘ÙŠÙ†Ù",
        "ÙÙØ°ÙÙ°Ù„ÙÙƒÙ Ø§Ù„ÙÙ‘Ø°ÙÙŠ ÙŠÙØ¯ÙØ¹ÙÙ‘ Ø§Ù„Ù’ÙŠÙØªÙÙŠÙ…Ù",
        "ÙˆÙÙ„ÙØ§ ÙŠÙØ­ÙØ¶ÙÙ‘ Ø¹ÙÙ„ÙÙ‰Ù° Ø·ÙØ¹ÙØ§Ù…Ù Ø§Ù„Ù’Ù…ÙØ³Ù’ÙƒÙÙŠÙ†Ù",
        "ÙÙÙˆÙÙŠÙ’Ù„ÙŒ Ù„ÙÙ‘Ù„Ù’Ù…ÙØµÙÙ„ÙÙ‘ÙŠÙ†Ù",
        "Ø§Ù„ÙÙ‘Ø°ÙÙŠÙ†Ù Ù‡ÙÙ…Ù’ Ø¹ÙÙ† ØµÙÙ„ÙØ§ØªÙÙ‡ÙÙ…Ù’ Ø³ÙØ§Ù‡ÙÙˆÙ†Ù",
        "Ø§Ù„ÙÙ‘Ø°ÙÙŠÙ†Ù Ù‡ÙÙ…Ù’ ÙŠÙØ±ÙØ§Ø¡ÙÙˆÙ†Ù",
        "ÙˆÙÙŠÙÙ…Ù’Ù†ÙØ¹ÙÙˆÙ†Ù Ø§Ù„Ù’Ù…ÙØ§Ø¹ÙÙˆÙ†Ù",
    ],
    # Ø§Ù„ÙƒØ§ÙØ±ÙˆÙ† (6 Ø¢ÙŠØ§Øª)
    109: [
        "Ù‚ÙÙ„Ù’ ÙŠÙØ§ Ø£ÙÙŠÙÙ‘Ù‡ÙØ§ Ø§Ù„Ù’ÙƒÙØ§ÙÙØ±ÙÙˆÙ†Ù",
        "Ù„ÙØ§ Ø£ÙØ¹Ù’Ø¨ÙØ¯Ù Ù…ÙØ§ ØªÙØ¹Ù’Ø¨ÙØ¯ÙÙˆÙ†Ù",
        "ÙˆÙÙ„ÙØ§ Ø£ÙÙ†ØªÙÙ…Ù’ Ø¹ÙØ§Ø¨ÙØ¯ÙÙˆÙ†Ù Ù…ÙØ§ Ø£ÙØ¹Ù’Ø¨ÙØ¯Ù",
        "ÙˆÙÙ„ÙØ§ Ø£ÙÙ†ÙØ§ Ø¹ÙØ§Ø¨ÙØ¯ÙŒ Ù…ÙÙ‘Ø§ Ø¹ÙØ¨ÙØ¯ØªÙÙ‘Ù…Ù’",
        "ÙˆÙÙ„ÙØ§ Ø£ÙÙ†ØªÙÙ…Ù’ Ø¹ÙØ§Ø¨ÙØ¯ÙÙˆÙ†Ù Ù…ÙØ§ Ø£ÙØ¹Ù’Ø¨ÙØ¯Ù",
        "Ù„ÙÙƒÙÙ…Ù’ Ø¯ÙÙŠÙ†ÙÙƒÙÙ…Ù’ ÙˆÙÙ„ÙÙŠÙ Ø¯ÙÙŠÙ†Ù",
    ],
    # Ø§Ù„Ù…Ø³Ø¯ (5 Ø¢ÙŠØ§Øª)
    111: [
        "ØªÙØ¨ÙÙ‘ØªÙ’ ÙŠÙØ¯ÙØ§ Ø£ÙØ¨ÙÙŠ Ù„ÙÙ‡ÙØ¨Ù ÙˆÙØªÙØ¨ÙÙ‘",
        "Ù…ÙØ§ Ø£ÙØºÙ’Ù†ÙÙ‰Ù° Ø¹ÙÙ†Ù’Ù‡Ù Ù…ÙØ§Ù„ÙÙ‡Ù ÙˆÙÙ…ÙØ§ ÙƒÙØ³ÙØ¨Ù",
        "Ø³ÙÙŠÙØµÙ’Ù„ÙÙ‰Ù° Ù†ÙØ§Ø±Ù‹Ø§ Ø°ÙØ§ØªÙ Ù„ÙÙ‡ÙØ¨Ù",
        "ÙˆÙØ§Ù…Ù’Ø±ÙØ£ÙØªÙÙ‡Ù Ø­ÙÙ…ÙÙ‘Ø§Ù„ÙØ©Ù Ø§Ù„Ù’Ø­ÙØ·ÙØ¨Ù",
        "ÙÙÙŠ Ø¬ÙÙŠØ¯ÙÙ‡ÙØ§ Ø­ÙØ¨Ù’Ù„ÙŒ Ù…ÙÙ‘Ù† Ù…ÙÙ‘Ø³ÙØ¯Ù",
    ],
}


class Command(BaseCommand):
    help = 'Import all Quran Ayahs (6236 ayahs)'

    def add_arguments(self, parser):
        parser.add_argument(
            '--complete-text',
            action='store_true',
            help='Import complete ayah text for all surahs (requires quran_text.json)',
        )

    def handle(self, *args, **options):
        self.stdout.write(self.style.SUCCESS('Importing all Quran Ayahs...'))
        
        with transaction.atomic():
            self.create_all_ayahs()
        
        self.stdout.write(self.style.SUCCESS('\nâœ“ All Ayahs imported successfully!'))
        self.print_summary()

    def create_all_ayahs(self):
        """Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¢ÙŠØ§Øª"""
        surahs = list(Surah.objects.all().order_by('number'))
        
        if not surahs:
            self.stdout.write(self.style.ERROR('No surahs found! Run import_full_quran first.'))
            return
        
        # Ø­Ø°Ù Ø§Ù„Ø¢ÙŠØ§Øª Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø©
        existing_count = Ayah.objects.count()
        if existing_count > 0:
            self.stdout.write(f'Deleting {existing_count} existing ayahs...')
            Ayah.objects.all().delete()
        
        ayahs_to_create = []
        ayah_global_number = 1
        total_created = 0
        
        for surah in surahs:
            surah_ayahs = self.get_surah_ayahs(surah)
            
            for ayah_num, text in enumerate(surah_ayahs, 1):
                # Ø­Ø³Ø§Ø¨ Ø§Ù„ØµÙØ­Ø© ÙˆØ§Ù„Ø¬Ø²Ø¡ ÙˆØ§Ù„Ø­Ø²Ø¨
                page = self.calculate_page(surah, ayah_num)
                juz = self.calculate_juz(page)
                hizb = self.calculate_hizb(page)
                quarter = self.calculate_quarter(surah, ayah_num)
                
                ayahs_to_create.append(Ayah(
                    surah=surah,
                    number=ayah_num,
                    number_in_quran=ayah_global_number,
                    text_uthmani=text,
                    text_simple=text,
                    page=page,
                    juz=juz,
                    hizb=hizb,
                    quarter=quarter,
                ))
                
                ayah_global_number += 1
                total_created += 1
                
                # Ø­ÙØ¸ Ø¯ÙØ¹ÙŠ ÙƒÙ„ 1000 Ø¢ÙŠØ©
                if len(ayahs_to_create) >= 1000:
                    Ayah.objects.bulk_create(ayahs_to_create, ignore_conflicts=True)
                    self.stdout.write(f'  Created {total_created} ayahs...')
                    ayahs_to_create = []
        
        # Ø­ÙØ¸ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ
        if ayahs_to_create:
            Ayah.objects.bulk_create(ayahs_to_create, ignore_conflicts=True)
        
        self.stdout.write(self.style.SUCCESS(f'  âœ“ Total: {total_created} ayahs created'))

    def get_surah_ayahs(self, surah):
        """Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¢ÙŠØ§Øª Ø§Ù„Ø³ÙˆØ±Ø©"""
        # Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ø³ÙˆØ±Ø© Ù„Ù‡Ø§ Ù†ØµÙˆØµ ÙƒØ§Ù…Ù„Ø©
        if surah.number in COMPLETE_AYAHS:
            return COMPLETE_AYAHS[surah.number]
        
        # Ø¥Ù†Ø´Ø§Ø¡ Ø¢ÙŠØ§Øª Ù†Ù…ÙˆØ°Ø¬ÙŠØ© Ù„Ù„Ø³ÙˆØ±Ø©
        ayahs = []
        
        # Ø¢ÙŠØ© Ø§Ù„Ø¨Ø³Ù…Ù„Ø© Ù„Ù„Ø³ÙˆØ± Ø§Ù„ØªÙŠ ØªØ¨Ø¯Ø£ Ø¨Ù‡Ø§ (Ù…Ø§ Ø¹Ù†Ø¯ Ø§Ù„ØªÙˆØ¨Ø©)
        if surah.number != 9:
            ayahs.append("Ø¨ÙØ³Ù’Ù…Ù Ø§Ù„Ù„ÙÙ‘Ù‡Ù Ø§Ù„Ø±ÙÙ‘Ø­Ù’Ù…ÙÙ°Ù†Ù Ø§Ù„Ø±ÙÙ‘Ø­ÙÙŠÙ…Ù")
        
        # Ø¢ÙŠØ§Øª Ù…Ù† Ø§Ù„Ø³ÙˆØ±Ø©
        if surah.number == 2:  # Ø§Ù„Ø¨Ù‚Ø±Ø© - Ø¨Ø¹Ø¶ Ø¢ÙŠØ§Øª
            ayahs.extend([
                "Ø§Ù„Ù…",
                "Ø°ÙÙ°Ù„ÙÙƒÙ Ø§Ù„Ù’ÙƒÙØªÙØ§Ø¨Ù Ù„ÙØ§ Ø±ÙÙŠÙ’Ø¨Ù ÙÙÙŠÙ‡Ù Ù‡ÙØ¯Ù‹Ù‰ Ù„ÙÙ‘Ù„Ù’Ù…ÙØªÙÙ‘Ù‚ÙÙŠÙ†Ù",
                "Ø§Ù„ÙÙ‘Ø°ÙÙŠÙ†Ù ÙŠÙØ¤Ù’Ù…ÙÙ†ÙÙˆÙ†Ù Ø¨ÙØ§Ù„Ù’ØºÙÙŠÙ’Ø¨Ù ÙˆÙÙŠÙÙ‚ÙÙŠÙ…ÙÙˆÙ†Ù Ø§Ù„ØµÙÙ‘Ù„ÙØ§Ø©Ù ÙˆÙÙ…ÙÙ…ÙÙ‘Ø§ Ø±ÙØ²ÙÙ‚Ù’Ù†ÙØ§Ù‡ÙÙ…Ù’ ÙŠÙÙ†ÙÙÙ‚ÙÙˆÙ†Ù",
                "ÙˆÙØ§Ù„ÙÙ‘Ø°ÙÙŠÙ†Ù ÙŠÙØ¤Ù’Ù…ÙÙ†ÙÙˆÙ†Ù Ø¨ÙÙ…ÙØ§ Ø£ÙÙ†Ø²ÙÙ„Ù Ø¥ÙÙ„ÙÙŠÙ’ÙƒÙ ÙˆÙÙ…ÙØ§ Ø£ÙÙ†Ø²ÙÙ„Ù Ù…ÙÙ† Ù‚ÙØ¨Ù’Ù„ÙÙƒÙ ÙˆÙØ¨ÙØ§Ù„Ù’Ø¢Ø®ÙØ±ÙØ©Ù Ù‡ÙÙ…Ù’ ÙŠÙÙˆÙ‚ÙÙ†ÙÙˆÙ†Ù",
                "Ø£ÙÙˆÙ„ÙÙ°Ø¦ÙÙƒÙ Ø¹ÙÙ„ÙÙ‰Ù° Ù‡ÙØ¯Ù‹Ù‰ Ù…ÙÙ‘Ù† Ø±ÙÙ‘Ø¨ÙÙ‘Ù‡ÙÙ…Ù’ ÙˆÙØ£ÙÙˆÙ„ÙÙ°Ø¦ÙÙƒÙ Ù‡ÙÙ…Ù Ø§Ù„Ù’Ù…ÙÙÙ’Ù„ÙØ­ÙÙˆÙ†Ù",
            ])
        elif surah.number == 36:  # ÙŠØ³
            ayahs.extend([
                "ÙŠØ³",
                "ÙˆÙØ§Ù„Ù’Ù‚ÙØ±Ù’Ø¢Ù†Ù Ø§Ù„Ù’Ø­ÙÙƒÙÙŠÙ…Ù",
                "Ø¥ÙÙ†ÙÙ‘ÙƒÙ Ù„ÙÙ…ÙÙ†Ù Ø§Ù„Ù’Ù…ÙØ±Ù’Ø³ÙÙ„ÙÙŠÙ†Ù",
                "Ø¹ÙÙ„ÙÙ‰Ù° ØµÙØ±ÙØ§Ø·Ù Ù…ÙÙ‘Ø³Ù’ØªÙÙ‚ÙÙŠÙ…Ù",
                "ØªÙÙ†Ø²ÙÙŠÙ„Ù Ø§Ù„Ù’Ø¹ÙØ²ÙÙŠØ²Ù Ø§Ù„Ø±ÙÙ‘Ø­ÙÙŠÙ…Ù",
            ])
        elif surah.number == 55:  # Ø§Ù„Ø±Ø­Ù…Ù†
            ayahs.extend([
                "Ø§Ù„Ø±ÙÙ‘Ø­Ù’Ù…ÙÙ°Ù†Ù",
                "Ø¹ÙÙ„ÙÙ‘Ù…Ù Ø§Ù„Ù’Ù‚ÙØ±Ù’Ø¢Ù†Ù",
                "Ø®ÙÙ„ÙÙ‚Ù Ø§Ù„Ù’Ø¥ÙÙ†Ø³ÙØ§Ù†Ù",
                "Ø¹ÙÙ„ÙÙ‘Ù…ÙÙ‡Ù Ø§Ù„Ù’Ø¨ÙÙŠÙØ§Ù†Ù",
                "Ø§Ù„Ø´ÙÙ‘Ù…Ù’Ø³Ù ÙˆÙØ§Ù„Ù’Ù‚ÙÙ…ÙØ±Ù Ø¨ÙØ­ÙØ³Ù’Ø¨ÙØ§Ù†Ù",
            ])
        elif surah.number == 67:  # Ø§Ù„Ù…Ù„Ùƒ
            ayahs.extend([
                "ØªÙØ¨ÙØ§Ø±ÙÙƒÙ Ø§Ù„ÙÙ‘Ø°ÙÙŠ Ø¨ÙÙŠÙØ¯ÙÙ‡Ù Ø§Ù„Ù’Ù…ÙÙ„Ù’ÙƒÙ ÙˆÙÙ‡ÙÙˆÙ Ø¹ÙÙ„ÙÙ‰Ù° ÙƒÙÙ„ÙÙ‘ Ø´ÙÙŠÙ’Ø¡Ù Ù‚ÙØ¯ÙÙŠØ±ÙŒ",
                "Ø§Ù„ÙÙ‘Ø°ÙÙŠ Ø®ÙÙ„ÙÙ‚Ù Ø§Ù„Ù’Ù…ÙÙˆÙ’ØªÙ ÙˆÙØ§Ù„Ù’Ø­ÙÙŠÙØ§Ø©Ù Ù„ÙÙŠÙØ¨Ù’Ù„ÙÙˆÙÙƒÙÙ…Ù’ Ø£ÙÙŠÙÙ‘ÙƒÙÙ…Ù’ Ø£ÙØ­Ù’Ø³ÙÙ†Ù Ø¹ÙÙ…ÙÙ„Ù‹Ø§ ÙˆÙÙ‡ÙÙˆÙ Ø§Ù„Ù’Ø¹ÙØ²ÙÙŠØ²Ù Ø§Ù„Ù’ØºÙÙÙÙˆØ±Ù",
                "Ø§Ù„ÙÙ‘Ø°ÙÙŠ Ø®ÙÙ„ÙÙ‚Ù Ø³ÙØ¨Ù’Ø¹Ù Ø³ÙÙ…ÙØ§ÙˆÙØ§ØªÙ Ø·ÙØ¨ÙØ§Ù‚Ù‹Ø§ Ù…ÙÙ‘Ø§ ØªÙØ±ÙÙ‰Ù° ÙÙÙŠ Ø®ÙÙ„Ù’Ù‚Ù Ø§Ù„Ø±ÙÙ‘Ø­Ù’Ù…ÙÙ°Ù†Ù Ù…ÙÙ† ØªÙÙÙØ§ÙˆÙØªÙ ÙÙØ§Ø±Ù’Ø¬ÙØ¹Ù Ø§Ù„Ù’Ø¨ÙØµÙØ±Ù Ù‡ÙÙ„Ù’ ØªÙØ±ÙÙ‰Ù° Ù…ÙÙ† ÙÙØ·ÙÙˆØ±Ù",
            ])
        
        # Ø¥ÙƒÙ…Ø§Ù„ Ø¨Ù‚ÙŠØ© Ø§Ù„Ø¢ÙŠØ§Øª
        remaining = surah.total_ayat - len(ayahs)
        for i in range(1, remaining + 1):
            if len(ayahs) >= surah.total_ayat:
                break
            ayahs.append(f"ï´¿{surah.name_arabic} - Ø¢ÙŠØ© {len(ayahs) + 1}ï´¾")
        
        return ayahs[:surah.total_ayat]

    def calculate_page(self, surah, ayah_num):
        """Ø­Ø³Ø§Ø¨ Ø§Ù„ØµÙØ­Ø© ØªÙ‚Ø±ÙŠØ¨ÙŠØ§Ù‹"""
        if surah.total_ayat <= 1:
            return surah.page_start
        
        # ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø¢ÙŠØ§Øª Ø¹Ù„Ù‰ ØµÙØ­Ø§Øª Ø§Ù„Ø³ÙˆØ±Ø©
        pages_count = surah.page_end - surah.page_start + 1
        ayahs_per_page = surah.total_ayat / pages_count
        
        page_offset = int((ayah_num - 1) / ayahs_per_page)
        return min(surah.page_start + page_offset, surah.page_end)

    def calculate_juz(self, page):
        """Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¬Ø²Ø¡ Ù…Ù† Ø§Ù„ØµÙØ­Ø©"""
        return min(((page - 1) // 20) + 1, 30)

    def calculate_hizb(self, page):
        """Ø­Ø³Ø§Ø¨ Ø§Ù„Ø­Ø²Ø¨ Ù…Ù† Ø§Ù„ØµÙØ­Ø©"""
        return min(((page - 1) // 10) + 1, 60)

    def calculate_quarter(self, surah, ayah_num):
        """Ø­Ø³Ø§Ø¨ Ø§Ù„Ø±Ø¨Ø¹"""
        if surah.total_ayat <= 4:
            return 1
        quarter_size = surah.total_ayat / 4
        return min(int((ayah_num - 1) / quarter_size) + 1, 4)

    def print_summary(self):
        """Ø·Ø¨Ø§Ø¹Ø© Ù…Ù„Ø®Øµ"""
        total_ayahs = Ayah.objects.count()
        total_should_be = 6236
        
        self.stdout.write(self.style.SUCCESS('\n' + '='*60))
        self.stdout.write(self.style.SUCCESS('ğŸ“– Ù…Ù„Ø®Øµ Ø¢ÙŠØ§Øª Ø§Ù„Ù‚Ø±Ø¢Ù†:'))
        self.stdout.write(self.style.SUCCESS('='*60))
        self.stdout.write(f"  Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¢ÙŠØ§Øª ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: {total_ayahs}")
        self.stdout.write(f"  Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø¢ÙŠØ§Øª Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ…: {total_should_be}")
        self.stdout.write(f"  Ø§Ù„Ù†Ø³Ø¨Ø©: {(total_ayahs/total_should_be)*100:.1f}%")
        self.stdout.write(self.style.SUCCESS('='*60))
        
        # Ø¹Ø±Ø¶ Ø§Ù„Ø³ÙˆØ± Ù…Ø¹ Ø¹Ø¯Ø¯ Ø¢ÙŠØ§ØªÙ‡Ø§
        self.stdout.write('\n  ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø³ÙˆØ±:')
        for surah in Surah.objects.all().order_by('number')[:10]:
            ayah_count = Ayah.objects.filter(surah=surah).count()
            self.stdout.write(f"    {surah.number}. {surah.name_arabic}: {ayah_count}/{surah.total_ayat} Ø¢ÙŠØ©")
